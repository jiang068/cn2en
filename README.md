# 中文名文件重命名工具

这是一个用于视觉小说里的中文名文件（如Ren'py游戏）的文件重命名工具包，主要用于将中文文件名转换为拼音，并自动更新相关的RPY文件中的引用。

（因为Ren'py在安卓端不支持中文名资源文件和中文名路径wwwww）

## 功能概述

- **rename.py**: 将中文文件名转换为拼音，支持文件和文件夹重命名
- **fix_rpy.py**: 自动修复RPY文件中的中文文件引用，更新为拼音文件名
- **chinese_dictionary.json**: 中文字符到拼音的映射字典

## 使用流程

### 1. 准备工作

确保你的工作目录中有以下文件：
- `rename.py`
- `fix_rpy.py`
- `chinese_dictionary.json`

### 2. 使用 rename.py 重命名文件

```bash
python rename.py
```

运行后会提示你输入目标文件夹路径，然后：

1. **输入目标路径**: 输入包含需要重命名文件的文件夹路径
2. **生成预览日志**: 程序会生成 `rename_log.txt` 文件，显示所有将要重命名的文件和文件夹
3. **确认操作**: 检查预览日志后，输入 `y` 确认执行重命名操作

#### 示例：
```
请输入目标文件夹路径: C:\game\audio
```

程序会：
- 扫描所有包含中文字符的文件和文件夹
- 根据字典将中文转换为拼音
- 移除中文标点符号、空格和省略号
- 保持英文字符、数字和文件扩展名不变

### 3. 使用 fix_rpy.py 修复RPY文件

在完成文件重命名后，运行：

```bash
python fix_rpy.py
```

程序会：

1. **加载字典**: 自动加载 `chinese_dictionary.json`
2. **输入RPY路径**: 提示输入包含RPY文件的目录路径
3. **生成更新映射**: 创建 `rpy_update_mapping.json` 文件，显示所有需要更新的RPY文件和具体修改内容
4. **确认更新**: 检查映射文件后，输入 `y` 确认执行更新操作

#### 示例：
```
请输入包含RPY文件的目录路径: C:\game\script
```

## 文件说明

### chinese_dictionary.json
这是中文字符到拼音的映射字典文件，格式如下：
```json
{
  "爱": "ai",
  "你": "ni",
  "好": "hao"
}
```

### 生成的文件

运行过程中会生成以下文件：

1. **rename_log.txt**: 文件重命名预览日志
2. **rename_mapping.json**: RPY文件更新映射（如果使用fix_rpy.py）

## 注意事项

### 字典完整性
- 在执行重命名前，程序会检查字典中是否包含所有需要的中文字符
- 如果字典不完整，程序会提示缺少的字符，请先完善字典后再执行

### 文件处理规则
- 会移除中文标点符号：`，。？！：；、""''【】（）〔〕《》〈〉`
- 会移除省略号：`…` 和 `...`
- 会移除空格（全角和半角）
- 保留英文字符、数字和英文标点符号
- 保持文件扩展名不变

### 安全性
- 程序会先生成预览日志，用户确认后才执行实际操作
- 建议在执行前备份重要文件
- 深层文件夹会优先重命名，避免路径冲突

## 使用示例

### 完整流程示例：

1. **重命名文件**：
```bash
python rename.py
# 输入: C:\game\audio
# 检查预览日志后确认: y
```

2. **修复RPY文件**：
```bash
python fix_rpy.py
# 输入: C:\game\script
# 检查映射文件后确认: y
```

### 典型的文件名转换示例：
- `你好世界.mp3` → `nihaoshijie.mp3`
- `背景音乐_1.ogg` → `beijingyinyue_1.ogg`
- `对话/角色A/问候.wav` → `duihua/jiaoA/wenhou.wav`

## 错误处理

如果遇到问题：
1. 检查文件路径是否正确
2. 确认字典文件存在且格式正确
3. 确保有足够的文件系统权限
4. 查看控制台输出的错误信息

## 系统要求

- Python 3.6+
- Windows/Linux/macOS
- 支持UTF-8编码

## 许可证

本工具仅供学习和个人使用。
